{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/disjoint-sets/","result":{"data":{"markdownRemark":{"html":"<p>Some applications involve grouping <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n\"></img> elements into a collection of disjoint sets. These applications often need to perform two operations in particular:</p>\n<ul>\n<li>finding the unique set that contains a given element</li>\n<li>uniting two sets together</li>\n</ul>\n<h2>Disjoint sets data structure</h2>\n<p>A disjoint set data structure maintains a collection <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\mathcal{S} = \\{S_1, S_2, \\dots, S_n\\}\"></img> of disjoint dynamics set. We identify each set by a representative, which is some member of the set. This data structure must support the following operations:</p>\n<ul>\n<li><code class=\"language-text\">make_set(x)</code> : creates a new set with x as its only element</li>\n<li><code class=\"language-text\">union(x, y)</code> : unites the dynamics sets that contain x and y, say <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?S_x\"></img> and <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?S_y\"></img> into a new set that is the union of these two sets. </li>\n<li><code class=\"language-text\">find_set(x)</code> : returns the representative of the unique set containing x.</li>\n</ul>\n<p>In the analysis we use <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n\"></img> to denote the number of <code class=\"language-text\">make_set</code> operations and <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?m\"></img> to denote the total number of <code class=\"language-text\">make_set</code>, <code class=\"language-text\">union</code> and <code class=\"language-text\">find_set</code> operations. </p>\n<p>One of the many applications of disjoint-set data structures is to arises in determining the connected components of an undirected graph. </p>\n<p>In this example application, we first create a simple disjoint set for every node. Then, we loop for each edge and we find to which sets the endpoints belong. If the sets are different we make an union. The total number of different unions correspond to the different sets. </p>\n<h2>Disjoint sets forests</h2>\n<p>In a disjoint sets forest each member points only to its parent. The root of each tree contains the representative and is its own parent. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/994df173989abb24ff6492429a23c5b2/8c857/2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABBElEQVQoz31S6YqGMAz0/d/NnwriieKB4n2f2Z0sKfXjYwOaOG0nM40G/ca+73QcB0p6nofzsix0nucL+8xY37bthRl4xXFMrusycN83Z9u2qSiKfwnruibTNBWGhwnLsqQgCJRKRJ7n1Pf9a7NOhqiqisIwpHEc1Zrh+z61bcuA4zi0rivXaIAD35TBpmVZyi6cgJgtJ0lC8zzzBzpd16UUDsPwUiiEEICG4gD7sJ8JobDrOmVDDgHXFQqepilFUcQ17h2kaOB53h8hLIoqPYDrkxfCpmlUI1gGjmnLVRk6CX4Vsf+pWHKWZawSgYZiWw1F7w7CaZq+TlZquBFHIJTrkvUfDda9a+T/D18AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png\"\n        title=\"2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png\"\n        src=\"/static/994df173989abb24ff6492429a23c5b2/c5bb3/2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png\"\n        srcset=\"/static/994df173989abb24ff6492429a23c5b2/04472/2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png 170w,\n/static/994df173989abb24ff6492429a23c5b2/9f933/2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png 340w,\n/static/994df173989abb24ff6492429a23c5b2/c5bb3/2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png 680w,\n/static/994df173989abb24ff6492429a23c5b2/8c857/2108c643f3e5fbbec2e6b9e9a3be2933798eb082.png 761w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>A <code class=\"language-text\">make_set</code> operation simply creates a tree with just one node. We perform a <code class=\"language-text\">find_set</code> operation by traversing the parent relationship until we reach the root (parent pointing to itself). The nodes visited on the simple path toward the root are the find path. </p>\n<h3>Heuristics to improve the running time</h3>\n<p>So far, we have that a single <code class=\"language-text\">find_set</code> might take <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(n)\"></img>, for example when the tree grows long and thin. We can use 2 heuristics to dramatically improve the running time of operations on disjoint sets:</p>\n<ul>\n<li>union by rank: the obvious approach is to make the root with fewer nodes point to the root of the tree with more nodes. In this way, when two sets are connected, the tree stays bushy, with lot of ramifications and small depth. Traversal then can not be so long. Instead of keeping the size, we keep for each node a rank. The rank is an upper bound on the height of the node. In union by rank, we make the root with smaller rank point to the root with larger rank during a <code class=\"language-text\">union</code> operation.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 631px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/cff321531677dec6661c1f71e154b883/4597d/5d64e421f6c85ab09dfeca0375f45801bf975b24.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAAA1UlEQVQoz3WQ2w6EIAxE+f9PRVG8KyrskdkQo7EPRtq5tSaltO/7uq4xxpTrPE/nXNd16aOO4wDQNI2B472v65pWGVdVNY7jgxNzAWNkrYVv6LZtC3pZloKjM8/zgzlNEzTBmF7OSkhU+H3f0w0hMBiGAQL9bdsU1eaSPxQMDBwIvFFlc/KjrS+3cLmQQJftMEcULX4gGrr3lXQwnOnLWVDkSIQiWjxxRssI9LgN8bSzRqDhKHyJeTmj976q9tcTACaCSUs7/6/9JrOYHEpmznEnMwXzA5juC/Z6uPdiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"5d64e421f6c85ab09dfeca0375f45801bf975b24.png\"\n        title=\"5d64e421f6c85ab09dfeca0375f45801bf975b24.png\"\n        src=\"/static/cff321531677dec6661c1f71e154b883/4597d/5d64e421f6c85ab09dfeca0375f45801bf975b24.png\"\n        srcset=\"/static/cff321531677dec6661c1f71e154b883/04472/5d64e421f6c85ab09dfeca0375f45801bf975b24.png 170w,\n/static/cff321531677dec6661c1f71e154b883/9f933/5d64e421f6c85ab09dfeca0375f45801bf975b24.png 340w,\n/static/cff321531677dec6661c1f71e154b883/4597d/5d64e421f6c85ab09dfeca0375f45801bf975b24.png 631w\"\n        sizes=\"(max-width: 631px) 100vw, 631px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>path compression: we use it during the <code class=\"language-text\">find_set</code> operations to make each node on the find path point directly to the root. Path compression does not change any ranks. As we go from a node to the parent, we recursively set the new node parent directly to the root. Next time we will try to search the set associated to this node the operation will be <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(1). \"></img> </li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/99c6fd80ad47d3ba994416e4949ac4be/cd1d6/8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 67.64705882352942%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAABiUlEQVQ4y41S2YoCQQzs//8ffVLEAwRv0VG8xwMFFY/xPmupsN227chuIHQyySSppBR+5fl8impbv5PJJPS7a2tf2QXdhPV6jUgkgsPh8BGzi9g11LfOrVYLvV4Pq9UK5/P5I67l8XjgdDq9JnTh3G43maxYLKLRaCBMWORyuWCz2WA0GiGRSIhvINud5/M5otGo8fkzlY2OxyN2u500XCwW8hJBKpVCEASvCW2Y4/FYlAW0dLtdDIdDtNtt9Pt9iXMdPBhtG6HSMNkhmUyi0+l87IsT5PN5pNNpZDIZZLNZyaWdy+Uk53q9CmwpyC7xePwNYtjVqXZcv1rv9zsUoXB0TmZfMOyi/xEVi8UwnU5NEVLE7exOqGkSpoqktQ/AXfwlmiKuGGKTT57nYTabmQsOBgP4vi8vucbrMk5aERF9rok5tDm1ufJyuUShUECz2US1WkW9XhefTcrlMkqlEiqVitgke61WE5txFmTh/X7/ThsSlh9JXu6RNtfB79vt1tg6j8qrupB/AO9rMzzmeyZ5AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png\"\n        title=\"8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png\"\n        src=\"/static/99c6fd80ad47d3ba994416e4949ac4be/c5bb3/8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png\"\n        srcset=\"/static/99c6fd80ad47d3ba994416e4949ac4be/04472/8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png 170w,\n/static/99c6fd80ad47d3ba994416e4949ac4be/9f933/8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png 340w,\n/static/99c6fd80ad47d3ba994416e4949ac4be/c5bb3/8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png 680w,\n/static/99c6fd80ad47d3ba994416e4949ac4be/b12f7/8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png 1020w,\n/static/99c6fd80ad47d3ba994416e4949ac4be/cd1d6/8218fa1b5ed84d6e4f6443d3462527ce8016b7d2.png 1141w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">make_set</span><span class=\"token punctuation\">(</span>node x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  x<span class=\"token punctuation\">.</span>p <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n  x<span class=\"token punctuation\">.</span>rank <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token keyword\">union</span><span class=\"token punctuation\">(</span>node x<span class=\"token punctuation\">,</span> node y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">link</span><span class=\"token punctuation\">(</span><span class=\"token function\">find_set</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">find_set</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">link</span><span class=\"token punctuation\">(</span>node x<span class=\"token punctuation\">,</span> node y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>rank <span class=\"token operator\">></span> y<span class=\"token punctuation\">.</span>rank<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>   <span class=\"token comment\">// union by rank</span>\n    y<span class=\"token punctuation\">.</span>p <span class=\"token operator\">=</span> x<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">else</span><span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">.</span>p <span class=\"token operator\">=</span> y<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>rank <span class=\"token operator\">==</span> y<span class=\"token punctuation\">.</span>rank<span class=\"token punctuation\">)</span> \n      y<span class=\"token punctuation\">.</span>rank<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">void</span> <span class=\"token function\">find_set</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>p <span class=\"token operator\">!=</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    x<span class=\"token punctuation\">.</span>p <span class=\"token operator\">=</span> <span class=\"token function\">find_set</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">.</span>p<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> x<span class=\"token punctuation\">.</span>p<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The <code class=\"language-text\">find_set</code> procedure is a two path method : as it recurses, it makes one pass up the find path to find the root, and as the recursion unwinds, it makes a second pass back down the find path to update each node to point directly to the root. </p>\n<h3>Analysis</h3>\n<p>On <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?m\"></img> operations the  combination of the two heuristics bring a worst case running time of <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(m\\alpha(n))\"></img> where <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\alpha(n)\"></img> is a very slowly growing function, in practice for <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n < 10^{80}\"></img> (ca the number of particles in the universe) , <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\alpha(n) \\leq 4\"></img>. We conclude that in any conceivable application we can view the running time as linear in <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?m\"></img>. </p>","frontmatter":{"title":"Disjoint Sets","description":"Array","image":{"childImageSharp":{"resize":{"src":"/static/dd830098fd6fb556f52d80a0e601846e/c7a62/5fc8a1ebf92b6025a6e906410845e042ec5833b5.jpg","height":630,"width":1200}}}}}},"pageContext":{"slug":"/disjoint-sets/","previousPost":{"title":"Encoding","slug":"/encoding/"},"nextPost":{"title":"Bits Manipulation","slug":"/bits-manipulation/"}}},"staticQueryHashes":["3868140423","4085307986"]}