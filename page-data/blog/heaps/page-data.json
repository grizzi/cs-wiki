{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/heaps/","result":{"data":{"markdownRemark":{"html":"<p>The heap is often an called priority queue and allows to implement a different sorting algorithm called heap sort. </p>\n<h2>Priority Queue</h2>\n<p>Implements a set S of elements and each of the elements is associated with a key.  The goal is to insert/add things with high priority. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/33dd319b7ab92f48f62456a79d74e468/2bef9/8597dee77566d378144a70596af5d9665e13be6c.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.64705882352941%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAAtklEQVQoz63RbwvBUBQG8DMkpaQULbMw24y504a8Jd//M3kOz60TeUFu/Tr3bvfPOfeKiEzl2YKX+HNLoIIC2vKH1occatjCilmPYcL/X7cWYwYNlMxYD5p/WBOQru3Q23V1YcEs9RrOcIMrXOBADefknK/VhDDy2Vm6aY+lDmAIeziB42Y78pWksIS1bjiD2Ij4LeJdhny41GTlY2YkPPBxkmOJlRk79gue7PuOseQjbjjWDY93CTANnD3kOh8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8597dee77566d378144a70596af5d9665e13be6c.png\"\n        title=\"8597dee77566d378144a70596af5d9665e13be6c.png\"\n        src=\"/static/33dd319b7ab92f48f62456a79d74e468/c5bb3/8597dee77566d378144a70596af5d9665e13be6c.png\"\n        srcset=\"/static/33dd319b7ab92f48f62456a79d74e468/04472/8597dee77566d378144a70596af5d9665e13be6c.png 170w,\n/static/33dd319b7ab92f48f62456a79d74e468/9f933/8597dee77566d378144a70596af5d9665e13be6c.png 340w,\n/static/33dd319b7ab92f48f62456a79d74e468/c5bb3/8597dee77566d378144a70596af5d9665e13be6c.png 680w,\n/static/33dd319b7ab92f48f62456a79d74e468/b12f7/8597dee77566d378144a70596af5d9665e13be6c.png 1020w,\n/static/33dd319b7ab92f48f62456a79d74e468/2bef9/8597dee77566d378144a70596af5d9665e13be6c.png 1024w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h3>Desirable operations</h3>\n<ul>\n<li><code class=\"language-text\">insert(S, x)</code> : insert element x into set S</li>\n<li><code class=\"language-text\">max(S)</code> : return element of S with the largest key</li>\n<li><code class=\"language-text\">extract_max(S)</code> : return element of S with the largest key and remove it from S</li>\n<li><code class=\"language-text\">increase(S, x, k)</code> : increase the value of x key to new value k.</li>\n</ul>\n<h2>Heap</h2>\n<p>The heap is an implementation of a priority queue. It is implemented as an array which is visualized as a nearly complete binary tree.</p>\n<p>The first element is the root. The element 1 and 2 are the children of the root. 3 and 4 are the children of 1, while 5 and 6 are the children of 2 and so forth. It is like we would do a breadth first traversal of the tree. As we traverse the tree we move one position forward, but the node adds 2 children with a cumulative offset of 1. Therefore for each new <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i\"></img> node, the <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i\"></img>th precedent nodes (given <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i=4\"></img> there are 0, 1, 2, 3 = 4 previous nodes) its children will be from an offset of exactly <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i\"></img> positions, with the first child being at <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i+1\"></img>.</p>\n<ul>\n<li>left child of node <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i\"></img> : <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?2i + 1\"></img></li>\n<li>right child of node <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i\"></img>: <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?2i + 2\"></img></li>\n<li>parent of node <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?i\"></img>: <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\lfloor (i -1/2)\\rfloor\"></img>   </li>\n</ul>\n<h3>Max Heap</h3>\n<p>The key of the node is <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\geq\"></img> the keys of its children. This definition is of course recursive. Note that the tree/array in the previous figure is a max heap. We would like to keep the heap property as we modify the heap (e.g. extracting the max). In this way we could sort the heap, by extracting sequentially always the max (we would have the sorted array in decreasing order).</p>\n<h3>Min Heap</h3>\n<p>The key of the node is <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\leq\"></img> the keys of its children. This definition is of course recursive. Same discussion as for the min heap.</p>\n<h2>Heap Operations</h2>\n<ul>\n<li><code class=\"language-text\">build_max_heap</code>: produces a max heap from an unordered array.</li>\n<li><code class=\"language-text\">max_heapify</code> : correct a single violation of the heap property in a subtreeâ€™s root. This takes something that is not quite a max heap, at some subtree level and is going to fix this violation.</li>\n</ul>\n<h3><code class=\"language-text\">max_heapify(A, i)</code></h3>\n<ul>\n<li>Assumes that the trees rooted at <code class=\"language-text\">left(i)</code> and <code class=\"language-text\">right(i)</code> are max heaps.</li>\n<li>If element <code class=\"language-text\">a[i]</code> violates the max heap property, we correct the violation by trickling element <code class=\"language-text\">a[i]</code> down the tree, making the subtree rooted at index <code class=\"language-text\">i</code>a max heap.</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3e89ede168577fe37559e0a5333b6735/8efc2/a564b3e769f92e77d84f5ef3036380cdbb41fe34.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 46.470588235294116%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABUklEQVQoz31S226CQBDlF/tb/Zmmb02f25iYmGqqBYrcBEEEdwG5KbCny3oJGO0kk9k5mT0zO2clgIExhosx1opYFjmqvDhj7OqXvD3nbe/cudTjGhA7uo7lxxhFWaJv/Zp7JvWLSn7Z31kgNEISJyiyHJRSRMEWGc+b9jR9csggJw5W+y1+qA2ZrmCkG+ip30047Pj89oSZ+z7AzNkcymiCI06EXhbi1RphHKh4MT8xCmSMtwqmkXGasDpUSGkMGhG44RKGqeJYHREGAXx7hX2ew7YtRP5GEDZtA1KmiKsMtNojq0scGt6O718Qdn21yRTuQhUXDPkXgbuG5/BnzWWBkSjkZ0UI8O8Ofc8DCSPQJIauaUgI4Q0YlooK0zLvCtFX/dYl33Ghf32LwrWmw54txMSeycXZkQEBbr7OPcWlDqrr+grUTSNiKxRlD//hI/sDtWS3ShutRRwAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"a564b3e769f92e77d84f5ef3036380cdbb41fe34.png\"\n        title=\"a564b3e769f92e77d84f5ef3036380cdbb41fe34.png\"\n        src=\"/static/3e89ede168577fe37559e0a5333b6735/c5bb3/a564b3e769f92e77d84f5ef3036380cdbb41fe34.png\"\n        srcset=\"/static/3e89ede168577fe37559e0a5333b6735/04472/a564b3e769f92e77d84f5ef3036380cdbb41fe34.png 170w,\n/static/3e89ede168577fe37559e0a5333b6735/9f933/a564b3e769f92e77d84f5ef3036380cdbb41fe34.png 340w,\n/static/3e89ede168577fe37559e0a5333b6735/c5bb3/a564b3e769f92e77d84f5ef3036380cdbb41fe34.png 680w,\n/static/3e89ede168577fe37559e0a5333b6735/8efc2/a564b3e769f92e77d84f5ef3036380cdbb41fe34.png 828w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<em>This heap has a violation at index 2, since its subtree does not satisfy the heap property. Node 10 is left child of node 5 but is drawn to the right for convenience.</em></p>\n<ul>\n<li>All that <code class=\"language-text\">max_heapify</code> does is exchange elements. It is going to look at the children and exchange with the largest child, in this case <code class=\"language-text\">a[2]</code> wiht a<code class=\"language-text\">[4]</code>. In this way the new parent will be larger then the unchosen child (keeping the max heap property).</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/fb0010e456d944f3650c3c062cfefbd3/30c92/8d6c20a1bf4baad7391f68b02ae701e569e53822.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.588235294117645%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABTElEQVQoz4VS207CQBDt7/pJfokPGjAB4wMJBUUrKGlL3W4vXEqLvWy3e5wuAbExcZqTmZ2cPTOdWUMphdZU+zWNjg9Zhh0PcLKWo/C/tTzjfEH9XAl9H/b4Cfs0/S1K+KoLHDRKikvkFKciR0GxFjwJNdTDlroK7BWErHWuqgWWJBwzX59ryj/wZ9x4I/TYBLefpvZ3zMRyzzRHCwpRQ0oF25rDm79DUq4sqHqRgy1teLZzLKoaDPkMfX+Kx/AVA/6CPgne8ylG0RxOGh5/ebMPcD24wqFJwBwP3F3B9zy4M0vPzrUWSKI12gmb8YI6G2MYWMiqHLsyw4YQ5Qm2ZQpjHcdI0wQTuwfOV1Cyges4GrUQujNBXkp57rJupMZfZtjWGzYsQMv/GJkQVYWIZhn6/LyMy8V0t9qFnuGpuqRnc7nxS9+N9bnDa+0bpftmyZmuU1gAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8d6c20a1bf4baad7391f68b02ae701e569e53822.png\"\n        title=\"8d6c20a1bf4baad7391f68b02ae701e569e53822.png\"\n        src=\"/static/fb0010e456d944f3650c3c062cfefbd3/c5bb3/8d6c20a1bf4baad7391f68b02ae701e569e53822.png\"\n        srcset=\"/static/fb0010e456d944f3650c3c062cfefbd3/04472/8d6c20a1bf4baad7391f68b02ae701e569e53822.png 170w,\n/static/fb0010e456d944f3650c3c062cfefbd3/9f933/8d6c20a1bf4baad7391f68b02ae701e569e53822.png 340w,\n/static/fb0010e456d944f3650c3c062cfefbd3/c5bb3/8d6c20a1bf4baad7391f68b02ae701e569e53822.png 680w,\n/static/fb0010e456d944f3650c3c062cfefbd3/30c92/8d6c20a1bf4baad7391f68b02ae701e569e53822.png 874w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<em>Now the max-heap property is violated at index 4 and we will make another call to the <code class=\"language-text\">max_heapify</code> routine. </em></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/37c9c3ed64eed242ef5740febe80bd7e/39a20/ee0bf93ae863a7aa68d9f749441a5b6704889b65.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.94117647058824%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAABOUlEQVQoz41S226CQBTcb+9X9Cv63pfe0j7UWg1WaUTuNbBABUFE5TbdXQuibVpPMtmTYZiBPYfUdQ1e4mSo6gqbLEO+3e35qsKR5p8i39LDSwz6aAyjL6HEwaBrykOb4n3JkFeFAOGCRrzbbhGGIZIkwTpNRb+gHrJVyiOFxl0HuHck3DkjPNA3PHsyRgsdg2CG10ABaZJ834N884hkGbfpBTNRnnqw5GnLBZsIg08VL9yAnZPQRFGVLUiWrRGzL/E9CtdxYOsGOOc5LryPORLWm5qGVbTEOUVy5qr0Blg6C0FMhxKiKAK1bLhTbf+bhoXAmrd3+BeITymSOEX//RZmOOSDhq7OYNpWMw10JiNu8tSkG0TMiSyI6/ElrsYXordVlYXER8LGDB2T39dGPPy5Hqercu4ufgHYR7imPTfUfAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ee0bf93ae863a7aa68d9f749441a5b6704889b65.png\"\n        title=\"ee0bf93ae863a7aa68d9f749441a5b6704889b65.png\"\n        src=\"/static/37c9c3ed64eed242ef5740febe80bd7e/c5bb3/ee0bf93ae863a7aa68d9f749441a5b6704889b65.png\"\n        srcset=\"/static/37c9c3ed64eed242ef5740febe80bd7e/04472/ee0bf93ae863a7aa68d9f749441a5b6704889b65.png 170w,\n/static/37c9c3ed64eed242ef5740febe80bd7e/9f933/ee0bf93ae863a7aa68d9f749441a5b6704889b65.png 340w,\n/static/37c9c3ed64eed242ef5740febe80bd7e/c5bb3/ee0bf93ae863a7aa68d9f749441a5b6704889b65.png 680w,\n/static/37c9c3ed64eed242ef5740febe80bd7e/39a20/ee0bf93ae863a7aa68d9f749441a5b6704889b65.png 859w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>This operation is bounded by <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\log n\"></img>. Differently from a binary tree which is not necessarily balanced, a heap is always balanced and therefore the amount of operation to perform is always <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(\\log n)\"></img>.  </p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token keyword\">void</span> <span class=\"token function\">max_heapify</span><span class=\"token punctuation\">(</span>std<span class=\"token operator\">::</span>vector<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span> A<span class=\"token punctuation\">,</span> size_t i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  size_t l <span class=\"token operator\">=</span> <span class=\"token function\">left</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  size_t r <span class=\"token operator\">=</span> <span class=\"token function\">right</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  size_t largest <span class=\"token operator\">=</span> i<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>l <span class=\"token operator\">&lt;=</span> <span class=\"token function\">heap_size</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> A<span class=\"token punctuation\">[</span>l<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    largest <span class=\"token operator\">=</span> l<span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>r <span class=\"token operator\">&lt;=</span> <span class=\"token function\">heap_size</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span> <span class=\"token operator\">and</span> A<span class=\"token punctuation\">[</span>r<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> A<span class=\"token punctuation\">[</span>largest<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> \n    largest <span class=\"token operator\">=</span> r<span class=\"token punctuation\">;</span>\n   \n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>largest <span class=\"token operator\">!=</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function\">swap</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> A<span class=\"token punctuation\">[</span>largest<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">max_heapify</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> largest<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">max_heapify</code> is a basic building block for the next algorithms. This is used for example in the <code class=\"language-text\">build_max_heap.</code></p>\n<h3><code class=\"language-text\">build_max_heap</code></h3>\n<ul>\n<li>Converts <code class=\"language-text\">a[1, ..., n]</code> into a max heap.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">vector<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span> <span class=\"token function\">build_max_heap</span><span class=\"token punctuation\">(</span>vector<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> A<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i<span class=\"token operator\">=</span>n<span class=\"token operator\">/</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">>=</span><span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">--</span><span class=\"token punctuation\">)</span> <span class=\"token function\">max_heapify</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  \n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>We start with the observation that leaves satisfy by definitions the heap property.  In the tree there are <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?(n + 1)/2 \"></img>  leaves. Meaning that we want only to satisfy the heap property from the leaves, all the way up moving to the root node.  </p>\n<p>Since we do <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(n)\"></img> steps and each take <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(\\log n) \"></img> we can deduce that the algorithm takes <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(n\\log n)\"></img>. With a more careful analysis we realize that in reality this algorithm takes <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(n)\"></img>. In fact at the leaves there are a lot of nodes ( <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n/2\"></img>) but they are already ordered. At the level just above the leaves, we have <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n/4\"></img> nodes to heapify but the height of the subtrees is only 2. At the level above we have <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n/8\"></img> nodes and the height of the tree is 3 and so forth. As we move up the <code class=\"language-text\">max_heapify</code> is performed on less nodes with larger height. Eventually these two factors compensate each other.</p>\n<ul>\n<li>Observe that <code class=\"language-text\">max_heapify</code> takes <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(1)\"></img> for nodes that are one level above the leaves and in general <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(l)\"></img> time for nodes that are <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?l\"></img> levels above the leaves.</li>\n<li><img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n/4 \"></img> nodes with level 1, <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n/8\"></img> nodes with level 2, ..., 1 node with <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?\\log_2n\"></img> levels. </li>\n</ul>\n<p>The total amount of work in the for loop is</p>\n<div class=\"block-equation-container\"><img src=\"https://latex.codecogs.com/svg.latex?\\begin{align*}\n&amp; n/4 \\cdot (1c) + n/8 \\cdot (2c)  + n/16 \\cdot (3c) + \\dots + 1 \\cdot \\log n =\\\\\n&amp; 2^kc \\left(\\frac{1}{2^0} + \\frac{2}{2^1} + \\frac{3}{2^2} + \\dots + \\frac{k+2}{2^k} \\right) \\leq \\\\\n&amp; 2^kc (2 \\cdot \\Sigma_{i=1}^\\infty i (1/2)^i) = \\\\\n&amp; 2^k c\\frac{2 \\cdot 1/2}{(1 -1/2)^2} = 2^kc \\cdot 4 = n \\cdot c = O(n)  \n\\end{align*} \"></div>\n<p>where we used <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?n/4 = 2^k\"></img>. See <a href=\"https://it.wikipedia.org/wiki/Lista_delle_serie_matematiche\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">here</a> for the series equation.</p>\n<h3>Heap Sort</h3>\n<p>We can trivially get the maximum element from the root element in the tree. Then after we take this element we swap it with the last element in the tree. Of course, in this status the array does not fulfill the max-heap property. Therefore we need to heapify the heap starting from the root. Once we do this we will have the nex max element at the root again. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/3e4760189402bd712cc56f5ea22e5edb/b04e4/8a4a435f32830a34005c2a641497044e142bd35f.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.94117647058823%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACDElEQVQ4y4VTCW7bMBDU/7/QvqJA0TcUaZo6Duz4imzrsinLpA5Koq7pSImcGHFRAgvqIIdzLC1wdF3XT8iTFHVR4n+jbdvLHiUlwlMIyfksz7A6/uxHjQ7BYgOxdVB3DZI4xvEgcFQZDkeBkwgReD6quoZJM0TrLXrINEshQgEVK2idwerBUm62p/MBuMhzzH/+QpwkkL4D9e0LpGMjTjUPUXB3O5zDEypdYLtYwuj8ir114qkhy5stUWUa0SGAff8Ib76kF2Qv9tTYvB6WZdj/eUISRsP75uERq4cJyrIY2LZcb63vJ/DsLZQQEI6DikyMStEkGb3qLna4zwtsJlPkWuMwXyGmX3LrIvcE6kS/M8xVDLXzEL3sIAL/iv5ovHBdCP53KbGQyeCfs1pDpTH2OoSdHrGKfczU/tXDIbnSkEp7O9aGqZqKVaOtGzRZjrYwDK9FWuXIqgK6LiENQ+koZ2QyyKsq5AzGGDPI60MylN7e/QCSCOPKuqlR3Wgxa5Q2gmqCuI6LwGc4mw18l3bQ0+r7V3Qn7wKogiP86TPZlcO3EcP66NVHpp9UEwxkRfFw6GXKthqSZlCSbTTu/8RwfL6qt+bXbJuQzB22lPQPQ7u8/H6EzSpzfVvyLcB+JH2iTzPYLENbYnZGzaZOj2xy9X5lrX9JHcDe5pYVOR5i+iZ5NU2c3bSlX/sXfffq6dmPOjUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"8a4a435f32830a34005c2a641497044e142bd35f.png\"\n        title=\"8a4a435f32830a34005c2a641497044e142bd35f.png\"\n        src=\"/static/3e4760189402bd712cc56f5ea22e5edb/c5bb3/8a4a435f32830a34005c2a641497044e142bd35f.png\"\n        srcset=\"/static/3e4760189402bd712cc56f5ea22e5edb/04472/8a4a435f32830a34005c2a641497044e142bd35f.png 170w,\n/static/3e4760189402bd712cc56f5ea22e5edb/9f933/8a4a435f32830a34005c2a641497044e142bd35f.png 340w,\n/static/3e4760189402bd712cc56f5ea22e5edb/c5bb3/8a4a435f32830a34005c2a641497044e142bd35f.png 680w,\n/static/3e4760189402bd712cc56f5ea22e5edb/b04e4/8a4a435f32830a34005c2a641497044e142bd35f.png 888w\"\n        sizes=\"(max-width: 680px) 100vw, 680px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\">vector<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span> <span class=\"token function\">heap_sort</span><span class=\"token punctuation\">(</span>vector<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span><span class=\"token operator\">&amp;</span> A<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n  <span class=\"token function\">build_max_heap</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// O(n)</span>\n  vector<span class=\"token operator\">&lt;</span>T<span class=\"token operator\">></span> sorted_out<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>A<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span> <span class=\"token comment\">// n times</span>\n    T max <span class=\"token operator\">=</span> A<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>       <span class=\"token comment\">// O(1) </span>\n    A<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">swap</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">[</span>n<span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// O(1) now max element is at the end of the array</span>\n    A<span class=\"token punctuation\">.</span><span class=\"token function\">pop_back</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>        <span class=\"token comment\">// O(1) discard last element</span>\n    <span class=\"token function\">max_heapify</span><span class=\"token punctuation\">(</span>A<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// O(log n) make vector heap again</span>\n    sorted_out<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span>max<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The algorithm has a loop running n times, and for each cycle it takes log n to heapify the vector again with a overall time complexity of <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(n\\log n)\"></img>.</p>\n<h3>Analysis</h3>\n<ul>\n<li>Is a sorted array really better? Nope because when we want to add a new element we need to search which is <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(\\log n)\"></img> but the insertion requires shifting all the other elements which is <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(n)\"></img>. Doubly linked list have constant time insertion but now search is linear time <img class=\"inline-equation-image\" src=\"https://latex.codecogs.com/svg.latex?O(n)\"></img>. With the heap we only need to heapify which is log n. </li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 493px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e22bbee7696932b764b624b9ab9f5b25/f88d0/ed0d76736999e531775ea02a232196da06146bb7.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 42.35294117647059%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABaUlEQVQoz22RCY+CMBCF+f8/ba+srhtEAbkRuQqUU+HtTFETk50wadM30/dN0W7XG4q8QJ7l/yZrl+QCy7RgW7Zak3OCg3GAeTTh2I7a7/W9qtWWeQHoe4nldR2HEXEYwfd8xFGMoR/guR4CP8A5PqtkI9lIaEzIgntyFQFnGIRwTo5qYoq6qp9UTNvKVpkwkbE3VH3f9cpIY4o8zVdHIkjILUsz+HcCbuIoaPwDNfP6iJaIeNSI6B+hLcsC1/dx5DciKp/cTHt9Ky4eyfU6XRES4fdmq/RxmhRhVpb41XWcXBc91U10Rm84o4sSdOcUXVqgvWTokhR9s47Fo/R1A2m5pOekkV5W6NsOre2p2o57sgITGWvzbUZtWCg3OsTOQHV0IN63kFTQchNdKOmi8m0D8bGF+NqhIQAel+vE547yB7UTYCBydWHVNGvW96S9EBVEKdakfSUlabXSBf0kddbIZ4+oKvWX/wDjvVpFKto51gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ed0d76736999e531775ea02a232196da06146bb7.png\"\n        title=\"ed0d76736999e531775ea02a232196da06146bb7.png\"\n        src=\"/static/e22bbee7696932b764b624b9ab9f5b25/f88d0/ed0d76736999e531775ea02a232196da06146bb7.png\"\n        srcset=\"/static/e22bbee7696932b764b624b9ab9f5b25/04472/ed0d76736999e531775ea02a232196da06146bb7.png 170w,\n/static/e22bbee7696932b764b624b9ab9f5b25/9f933/ed0d76736999e531775ea02a232196da06146bb7.png 340w,\n/static/e22bbee7696932b764b624b9ab9f5b25/f88d0/ed0d76736999e531775ea02a232196da06146bb7.png 493w\"\n        sizes=\"(max-width: 493px) 100vw, 493px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<ul>\n<li>C++ <code class=\"language-text\">std::priority_queue</code>, <code class=\"language-text\">std::make_heap</code>, <code class=\"language-text\">std::pop_heap</code></li>\n</ul>","frontmatter":{"title":"Heaps","description":"Array","image":{"childImageSharp":{"resize":{"src":"/static/698ca3e1402c3ffbeb09ae5df422eccb/c7a62/8fb35fcf5c35fba5c9c7e3eb5cb28bc23d91b86b.jpg","height":630,"width":1200}}}}}},"pageContext":{"slug":"/heaps/","previousPost":{"title":"Introduction and Big O Notation","slug":"/introduction-and-big-o-notation/"},"nextPost":{"title":"Hash Table","slug":"/hash-table/"}}},"staticQueryHashes":["3868140423","4085307986"]}